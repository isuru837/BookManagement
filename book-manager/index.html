{% extends "base.html" %}
{% block content %}
  <div class="row mb-3">
    <div class="col-md-8"><h3>All Books</h3></div>
    <div class="col-md-4">
      <form method="get" action="{{ url_for('index') }}" class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search by title or author" aria-label="Search" name="q" value="{{ q }}">
        <button class="btn btn-outline-secondary" type="submit">Search</button>
      </form>
    </div>
  </div>

  {% if books %}
    <table class="table table-striped">
      <thead>
        <tr>
          <th>#</th>
          <th>Front</th>
          <th>Back</th>
          <th>Title</th>
          <th>Author</th>
          <th>Year</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for book in books %}
          <tr>
            <td>{{ book.id }}</td>
            <td>
              {% if book.front_image %}
                <img src="{{ url_for('static', filename='uploads/' + book.front_image) }}" width="50">
              {% endif %}
            </td>
            <td>
              {% if book.back_image %}
                <img src="{{ url_for('static', filename='uploads/' + book.back_image) }}" width="50">
              {% endif %}
            </td>
            <td>{{ book.title }}</td>
            <td>{{ book.author }}</td>
            <td>{{ book.year or '' }}</td>
            <td>
              <a class="btn btn-sm btn-primary" href="{{ url_for('edit_book', book_id=book.id) }}">Edit</a>
              <form method="post" action="{{ url_for('delete_book', book_id=book.id) }}" style="display:inline-block" onsubmit="return confirm('Delete this book?');">
                <button class="btn btn-sm btn-danger" type="submit">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div class="alert alert-info">No books found. Add your first book!</div>
  {% endif %}
{% endblock %}
